
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Tennessee Weather Dashboard</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
  #map { height: 700px; }
  body { font-family: Arial, sans-serif; }
</style>
</head>
<body>
<h2>Tennessee Weather Dashboard</h2>
<p>Click on a county to view current conditions and 7-day forecast.</p>
<div id="map"></div>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
var map = L.map('map').setView([35.5175, -86.5804], 7);

// OpenStreetMap tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
}).addTo(map);

// HRRR Radar overlay (example, may require correct tile server)
L.tileLayer('https://www.meteo.psu.edu/ewall/HRRR15_CUR/{z}/{x}/{y}.png', {
  attribution: 'HRRR Radar'
}).addTo(map);

// GOES Satellite overlay
L.tileLayer('https://www.meteo.psu.edu/ewall/PSUGOES_US/loop30i/{z}/{x}/{y}.png', {
  attribution: 'GOES Satellite'
}).addTo(map);

// Load TN counties GeoJSON
fetch('data/geojson/tn_counties.geojson')
  .then(response => response.json())
  .then(data => {
    L.geoJSON(data, {
      onEachFeature: function(feature, layer) {
        layer.on('click', function() {
          var lat = layer.getBounds().getCenter().lat;
          var lon = layer.getBounds().getCenter().lng;

          // Replace YOUR_API_KEY with your OpenWeatherMap API key
          fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&units=imperial&appid=YOUR_API_KEY`)
            .then(res => res.json())
            .then(weather => {
              var popupContent = `<strong>${feature.properties.NAME} County</strong><br>`;
              popupContent += `Current: ${weather.current.temp}°F, ${weather.current.weather[0].description}<br>`;
              popupContent += '7-day forecast:<br>';
              weather.daily.forEach(function(day) {
                popupContent += `Day: ${day.temp.day}°F, ${day.weather[0].main}<br>`;
              });
              layer.bindPopup(popupContent).openPopup();
            }).catch(err => {
              layer.bindPopup('Weather data not available').openPopup();
            });
        });
      }
    }).addTo(map);
  })
  .catch(error => console.log('Error loading GeoJSON:', error));
</script>
</body>
</html>
