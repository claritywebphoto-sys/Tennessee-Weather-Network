<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tennessee Weather Network</title>
<style>
body { font-family: Arial, sans-serif; margin:0; background:#f4f6f8; color:#222; }
header { background:#1e3a8a; color:#fff; padding:1rem; text-align:center; }
h1 { margin:0; }
.container { display:grid; grid-template-columns:1fr 1fr; gap:1rem; padding:1rem; }
.card { background:#fff; padding:1rem; border-radius:12px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
iframe { width:100%; height:400px; border:none; border-radius:12px; }
.forecast { display:flex; gap:1rem; overflow-x:auto; }
.day { background:#e0e7ff; padding:0.5rem; border-radius:8px; flex:0 0 120px; text-align:center; }
footer { text-align:center; padding:1rem; background:#1e3a8a; color:#fff; margin-top:1rem; }
</style>
</head>
<body>

<header>
<h1>üå§Ô∏è Tennessee Weather Network</h1>
<p>Live Conditions, Forecast, Radar & Alerts</p>
</header>

<div class="container">

<div class="card" id="current">
  <h2>Current Conditions (Nashville)</h2>
  <p id="conditions">Loading...</p>
</div>

<div class="card">
  <h2>7-Day Forecast</h2>
  <div class="forecast" id="forecast"></div>
</div>

<div class="card">
  <h2>Live HRRR Radar</h2>
  <iframe src="https://www.meteo.psu.edu/ewall/HRRR15_CUR/" title="HRRR Radar"></iframe>
</div>

<div class="card">
  <h2>GOES Satellite (U.S.)</h2>
  <iframe src="https://www.meteo.psu.edu/ewall/PSUGOES_US/loop30i.html" title="GOES Satellite"></iframe>
</div>

<div class="card" style="grid-column: span 2;">
  <h2>Alerts & Warnings (TN)</h2>
  <div id="alerts">Loading...</div>
</div>

</div>

<footer>
<p>¬© 2025 Tennessee Weather Network | Powered by OpenWeatherMap & PSU Meteo</p>
</footer>

<script>
const API_KEY = "YOUR_OPENWEATHERMAP_API_KEY"; // Replace with your OpenWeatherMap key
const LAT = 36.1627;
const LON = -86.7816;

// Current conditions & forecast
async function loadWeather() {
  try {
    const url = `https://api.openweathermap.org/data/2.5/onecall?lat=${LAT}&lon=${LON}&exclude=minutely,hourly&units=imperial&appid=${API_KEY}`;
    const res = await fetch(url);
    const data = await res.json();

    // Current
    const cur = data.current;
    document.getElementById("conditions").innerHTML =
      `üå°Ô∏è Temp: ${cur.temp}¬∞F | üí® Wind: ${cur.wind_speed} mph | ${cur.weather[0].description}`;

    // 7-day forecast
    const forecastEl = document.getElementById("forecast");
    forecastEl.innerHTML = "";
    data.daily.slice(0,7).forEach(day => {
      const date = new Date(day.dt*1000).toLocaleDateString('en-US', {weekday:'short', month:'short', day:'numeric'});
      forecastEl.innerHTML += `
        <div class="day">
          <strong>${date}</strong><br>
          üå°Ô∏è ${day.temp.max.toFixed(0)}¬∞ / ${day.temp.min.toFixed(0)}¬∞F<br>
          ${day.weather[0].main}
        </div>
      `;
    });
  } catch(err){
    console.error(err);
    document.getElementById("conditions").innerHTML = "Error loading weather data.";
  }
}

// Alerts
async function loadAlerts() {
  try {
    const res = await fetch("https://api.weather.gov/alerts/active?area=TN");
    const data = await res.json();
    const alertsEl = document.getElementById("alerts");

    if (!data.features || data.features.length === 0) {
      alertsEl.innerHTML = "<p>No active alerts.</p>";
      return;
    }

    let html = "";
    data.features.forEach(alert => {
      html += `<p><strong>${alert.properties.event}</strong>: ${alert.properties.headline}</p><p>${alert.properties.description}</p><hr>`;
    });
    alertsEl.innerHTML = html;
  } catch(err){
    console.error(err);
    document.getElementById("alerts").innerHTML = "Error loading alerts.";
  }
}

loadWeather();
loadAlerts();
</script>

</body>
</html>
